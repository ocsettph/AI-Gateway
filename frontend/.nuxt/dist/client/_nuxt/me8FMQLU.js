import{e as _,u as J,r as s,g as V,h as E,c as r,a as e,p as k,k as d,q as y,v as B,F as A,l as C,d as D,z as K,t as n,o as i}from"#entry";const R={class:"min-h-screen py-10 bg-transparent dark:bg-transparent"},$={class:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8"},z={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-4 md:p-6"},j={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},F={class:"md:col-span-3"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},L=["value"],q={class:"flex items-center md:items-end"},H={class:"inline-flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300"},Q={key:0,class:"mb-4"},W={class:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-4"},X={key:0,class:"text-xs sm:text-sm text-gray-600 dark:text-gray-300 whitespace-nowrap"},Y={key:1,class:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 whitespace-nowrap"},Z={class:"bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 p-3 md:p-4 rounded overflow-auto text-xs sm:text-sm max-h-64 md:max-h-96"},tt={class:"mt-6 md:mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-4 md:p-6"},et={class:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3"},at=["value"],st={class:"md:col-span-2"},lt={class:"flex items-center gap-3 mb-3"},ot=["disabled"],rt={key:0,class:"text-sm text-gray-600 dark:text-gray-300"},dt={class:"bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 p-4 rounded overflow-auto text-sm max-h-72"},ut=_({__name:"api-playground",setup(nt){J({title:"API Playground - UBU AI SERVICE"});const m=s("GET"),f=s(V().public.apiBase+"/health"),w=s(""),h=s(!0),p=s(""),u=s([]),o=s(""),g=s(""),b=s(null),S=s(null),I=async()=>{try{g.value="",b.value=null;const l=performance.now(),t={},a=u.value.find(N=>String(N.id)===String(o.value)),c=a?.key_value?`Bearer ${a.key_value}`:w.value.trim();c&&(t.Authorization=c),m.value==="POST"&&(t["Content-Type"]="application/json");const O=await fetch(f.value,{method:m.value,headers:t,body:m.value==="POST"&&p.value?p.value:void 0,credentials:h.value?"include":"omit"});S.value=Math.round(performance.now()-l),b.value=O.status;const U=await O.text();try{g.value=JSON.stringify(JSON.parse(U),null,2)}catch{g.value=U}}catch(l){g.value=l?.message||String(l)}};E(()=>{p.value=JSON.stringify({hello:"world"},null,2),(async()=>{try{const l=V().public.apiBase,t=await $fetch(`${l}/api/keys`,{credentials:"include"});if(u.value=t?.keys||[],!o.value&&u.value.length){const a=u.value.find(c=>c.is_active);o.value=String((a||u.value[0]).id)}}catch{}})()});const P=s("openai/gpt-4o"),T=s("สวัสดีครับ"),v=s(""),x=s(""),M=async()=>{if(!o.value){x.value="ต้องเลือก API Key ก่อน";return}v.value="",x.value="กำลังส่ง...";try{const l=V().public.apiBase,t=await fetch(`${l}/api/test-model`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({keyId:o.value,model:P.value,prompt:T.value})});x.value=String(t.status);const a=await t.text();try{v.value=JSON.stringify(JSON.parse(a),null,2)}catch{v.value=a}}catch(l){x.value="error",v.value=l?.message||String(l)}};return(l,t)=>(i(),r("div",R,[e("div",$,[t[24]||(t[24]=e("div",{class:"mb-6 md:mb-8 text-center"},[e("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white"}," API Playground "),e("p",{class:"text-sm sm:text-base text-gray-600 dark:text-gray-300 px-4"}," ทดสอบเรียกใช้งาน API ได้จากหน้านี้ (ตัวอย่างค่าเริ่มต้นจะทดสอบ /health ของระบบ) ")],-1)),e("div",z,[e("div",j,[e("div",F,[t[9]||(t[9]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"URL",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>f.value=a),type:"text",class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white text-sm"},null,512),[[y,f.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"Method",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a),class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white text-sm"},[...t[10]||(t[10]=[e("option",null,"GET",-1),e("option",null,"POST",-1)])],512),[[B,m.value]])])]),e("div",G,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"API Key ของคุณ (ถ้ามี)",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value=a),class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white text-sm"},[t[12]||(t[12]=e("option",{value:""},"-- ไม่ใช้ --",-1)),(i(!0),r(A,null,C(u.value,a=>(i(),r("option",{key:a.id,value:a.id},n(a.name)+" ("+n(a.is_active?"Active":"Disabled")+")",9,L))),128))],512),[[B,o.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"Authorization",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>w.value=a),type:"text",placeholder:"Bearer <your_api_token> (ถ้ามี)",class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white text-sm"},null,512),[[y,w.value]])]),e("div",q,[e("label",H,[d(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=a=>h.value=a),class:"mr-2"},null,512),[[K,h.value]]),t[15]||(t[15]=D(" ส่งพร้อม cookie session ",-1))])])]),m.value==="POST"?(i(),r("div",Q,[t[16]||(t[16]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"JSON Body",-1)),d(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=a=>p.value=a),rows:"6",class:"w-full px-3 py-2 border rounded font-mono text-xs sm:text-sm dark:bg-gray-700 dark:text-white"},null,512),[[y,p.value]])])):k("",!0),e("div",W,[e("button",{onClick:I,class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 text-sm whitespace-nowrap"}," ส่งคำขอ "),S.value!==null?(i(),r("span",X,"เวลาตอบสนอง: "+n(S.value)+" ms",1)):k("",!0),b.value!==null?(i(),r("span",Y,"สถานะ: "+n(b.value),1)):k("",!0)]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"ผลลัพธ์",-1)),e("pre",Z,n(g.value),1)])]),e("div",tt,[t[23]||(t[23]=e("h2",{class:"text-lg md:text-xl font-semibold text-gray-900 dark:text-white mb-4"},"ทดสอบ Model",-1)),e("div",et,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-xs sm:text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"Model",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>P.value=a),placeholder:"openai/gpt-4o",class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white text-sm"},null,512),[[y,P.value]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"API Key ของคุณ",-1)),d(e("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>o.value=a),class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white"},[t[19]||(t[19]=e("option",{value:""},"-- เลือกคีย์ --",-1)),(i(!0),r(A,null,C(u.value,a=>(i(),r("option",{key:a.id,value:a.id},n(a.name)+" ("+n(a.is_active?"Active":"Disabled")+")",9,at))),128))],512),[[B,o.value]])]),e("div",st,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"ข้อความ",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>T.value=a),placeholder:"พิมพ์ข้อความทดสอบ...",class:"w-full px-3 py-2 border rounded dark:bg-gray-700 dark:text-white"},null,512),[[y,T.value]])])]),e("div",lt,[e("button",{onClick:M,disabled:!o.value,class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"},"ส่งทดสอบ",8,ot),x.value?(i(),r("span",rt,"สถานะ: "+n(x.value),1)):k("",!0)]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium mb-1 text-gray-700 dark:text-gray-300"},"ผลลัพธ์",-1)),e("pre",dt,n(v.value),1)])])])]))}});export{ut as default};
